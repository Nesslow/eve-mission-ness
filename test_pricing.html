<!DOCTYPE html>
<html>
<head>
    <title>ESI Pricing Implementation Test</title>
</head>
<body>
    <h1>ESI Pricing Implementation Test</h1>
    <p>This page demonstrates the new ESI-based pricing system.</p>
    
    <h2>Implementation Details</h2>
    <ul>
        <li><strong>ESI Base URL:</strong> https://esi.evetech.net/latest</li>
        <li><strong>The Forge Region ID:</strong> 10000002</li>
        <li><strong>Jita 4-4 Station ID:</strong> 60003760</li>
    </ul>
    
    <h2>Pricing Algorithm</h2>
    <ol>
        <li>Fetch all sell orders from The Forge region for each item</li>
        <li>Filter orders to include only those at Jita 4-4 station</li>
        <li>Sort filtered orders by price (ascending)</li>
        <li>Calculate volume of lowest 5% of orders</li>
        <li>Return weighted average price of those orders</li>
    </ol>
    
    <h2>Error Handling</h2>
    <ul>
        <li>Falls back to Fuzzwork API when ESI is unavailable</li>
        <li>Handles network failures gracefully</li>
        <li>Provides detailed logging for debugging</li>
        <li>Returns 0 when no pricing data is available</li>
    </ul>
    
    <h2>Usage</h2>
    <p>The pricing system is automatically used when adding ships in the main application. The <code>calculateShipValue</code> function processes ship fittings and returns the total estimated value based on current Jita 4-4 market prices.</p>
    
    <h2>Implementation Status</h2>
    <p>âœ… ESI-based pricing system implemented with all required features:<br>
    - ESI constants defined<br>
    - Market data fetching from The Forge region<br>
    - Jita 4-4 station filtering<br>
    - Price sorting and weighted average calculation<br>
    - Robust error handling and logging<br>
    - Fallback to Fuzzwork API</p>
</body>
</html>